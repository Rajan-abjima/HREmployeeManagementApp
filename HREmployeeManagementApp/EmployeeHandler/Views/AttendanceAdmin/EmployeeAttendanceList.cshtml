@model AttendanceViewModel

@section head{
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Akatab:wght@400;700&display=swap" rel="stylesheet">
}

@{
    var employeeID = Context.Request.Query["EmployeeID"];
}

<style>
    /*body {
        font-family: 'Akatab', sans-serif;
        background-color: #0076d1;
        background-image: url("https://www.transparenttextures.com/patterns/3px-tile.png");
    }*/

    h1 {
        font: 700;
    }

    th, td {
        padding-left: 2vw !important;
    }
</style>

<section id="tabs" class="project-tab">
    <div class="container">
        <div class="row">
            <h1 align="center">@Model.EmployeeDetails.FirstName's Attendance</h1>
            <div class="col-md-12">
                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                        <table id="myTable" class="table table-bordered table-striped table-hover mx-auto bg-light" cellspacing="0">
                            <thead>
                                <tr>
                                    <th class="text-center" scope="col">Date</th>
                                    <th class="text-center" scope="col">CheckIn</th>
                                    <th class="text-center" scope="col">CheckOut</th>
                                    <th class="text-center" scope="col">Status</th>
                                    <th class="text-center" scope="col">Is Regularized</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                @*@foreach (var attendance in Model)
                                {
                                    <tr class="">
                                        <td class="text-center">@attendance.Date</td>
                                        <td class="text-center">@attendance.CheckIn</td>
                                        <td class="text-center">@attendance.CheckOut</td>
                                        <td class="text-center">@attendance.Status</td>
                                        <td class="text-center">@if (attendance.ModifiedBy != null) {<text>Yes</text>}</td>
                                    </tr>
                                }*@
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>
    </div>
</section>
@section Scripts{
    <script>
        function employeeAttendanceTable(){
            var employeeID = @employeeID;
            $.ajax({
				type: "GET",
                url: "/AttendanceAdmin/EmployeeAttendanceListPartial",
				dataType: 'json',
				data: {
					employeeID: employeeID
				},
				success: function (data) {

					var rows = "";
					for (var x = 0; x < data.length; x++) {
						rows += "<tr class=''>"
						rows += "<td>" + data[x].date.substring(0, 10) + "</td>"
						rows += "<td>" + data[x].checkIn.substring(11, 19) + "</td>"
						rows += "<td>" + data[x].checkOut.substring(11, 19) + "</td>"
						rows += "<td>" + data[x].status + "</td>"
						if (data[x].isRegularised == true)
						{rows += '<td><img width="20" src="/confirm-icon_black.svg"></td>'}
						else
						{rows += "<td>"+JSON.stringify(data[x].isRegularized)+"</td>"}
						rows += "<td><a onClick='regularize(" + data[x].attendanceID + ")' class='btn btn-outline-primary regularize' data-toggle='modal' rel='modal:open' href='#regularizeModal'>Regularize</a></td>"
						rows += "</tr>";
					};
					$('#myTable tbody').html(rows);
					$('#myTable').dataTable({
					});
				},
				error: function (ex) {
					//console.log(error);
					var r = jQuery.parseJSON(response.responseText);
					alert("Message: " + r.Message);
					alert("StackTrace: " + r.StackTrace);
					alert("ExceptionType: " + r.ExceptionType);
				}
			});
        }

        $(document).ready(function () {
            employeeAttendanceTable();
        });
    </script>
}